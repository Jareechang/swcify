{"version":3,"sources":["index.ts"],"names":["path","require","loadBinding","nativeBindings","join","__dirname","transform","src","options","isModule","jsc","parser","syntax","JSON","stringify","toBuffer","transformSync","raw","Buffer","from"],"mappings":";;;;;;;;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAkBD,OAAO,CAAC,iBAAD,CAA/B,C,CAEA;AACA;;;AACA,MAAME,cAAc,GAAGD,WAAW,CAChCF,IAAI,CAACI,IAAL,CAAUC,SAAV,EAAqB,QAArB,CADgC,EAEhC,QAFgC,EAGhC,QAHgC,CAAlC;;AAUO,eAAeC,SAAf,CAAyBC,GAAzB,EAAmCC,OAAnC,EAAiD;AAAA;;AACtD,QAAMC,QAAQ,GAAG,OAAOF,GAAP,KAAe,QAAhC;;AAEA,MAAIC,OAAJ,aAAIA,OAAJ,+BAAIA,OAAO,CAAEE,GAAb,yCAAI,aAAcC,MAAlB,EAA0B;AAAA;;AACxBH,IAAAA,OAAO,CAACE,GAAR,CAAYC,MAAZ,CAAmBC,MAAnB,4BAA4BJ,OAAO,CAACE,GAAR,CAAYC,MAAZ,CAAmBC,MAA/C,yEAAyD,YAAzD;AACD;;AAED,SAAOT,cAAc,CAACG,SAAf,CACLG,QAAQ,GAAGI,IAAI,CAACC,SAAL,CAAeP,GAAf,CAAH,GAAyBA,GAD5B,EAELE,QAFK,EAGLM,QAAQ,CAACP,OAAD,CAHH,CAAP;AAKD;;AAEM,SAASQ,aAAT,CAAuBT,GAAvB,EAA4BC,OAAY,GAAG,EAA3C,EAA+C;AAAA;;AACpD,QAAMC,QAAQ,GAAG,OAAOF,GAAP,KAAe,QAAhC;;AAEA,MAAIC,OAAJ,aAAIA,OAAJ,gCAAIA,OAAO,CAAEE,GAAb,0CAAI,cAAcC,MAAlB,EAA0B;AAAA;;AACxBH,IAAAA,OAAO,CAACE,GAAR,CAAYC,MAAZ,CAAmBC,MAAnB,6BAA4BJ,OAAO,CAACE,GAAR,CAAYC,MAAZ,CAAmBC,MAA/C,2EAAyD,YAAzD;AACD;;AAED,SAAOT,cAAc,CAACa,aAAf,CACLP,QAAQ,GAAGI,IAAI,CAACC,SAAL,CAAeP,GAAf,CAAH,GAAyBA,GAD5B,EAELE,QAFK,EAGLM,QAAQ,CAACP,OAAD,CAHH,CAAP;AAKD;;AAED,SAASO,QAAT,CAAkBE,GAAlB,EAAuB;AACrB,SAAOC,MAAM,CAACC,IAAP,CAAYN,IAAI,CAACC,SAAL,CAAeG,GAAf,CAAZ,CAAP;AACD","sourcesContent":["const path = require(\"path\");\nconst { loadBinding } = require(\"@node-rs/helper\");\n\n// grabs the appropriate native code for our platform\n// (\"swcify\" is the name defined in package.json)\nconst nativeBindings = loadBinding(\n  path.join(__dirname, \"native\"),\n  \"swcify\",\n  \"swcify\"\n);\n\nexport interface Options {\n  jsc: any;\n}\n\nexport async function transform(src: any, options: any) {\n  const isModule = typeof src !== \"string\";\n\n  if (options?.jsc?.parser) {\n    options.jsc.parser.syntax = options.jsc.parser.syntax ?? \"ecmascript\";\n  }\n\n  return nativeBindings.transform(\n    isModule ? JSON.stringify(src) : src,\n    isModule,\n    toBuffer(options)\n  );\n}\n\nexport function transformSync(src, options: any = {}) {\n  const isModule = typeof src !== \"string\";\n\n  if (options?.jsc?.parser) {\n    options.jsc.parser.syntax = options.jsc.parser.syntax ?? \"ecmascript\";\n  }\n\n  return nativeBindings.transformSync(\n    isModule ? JSON.stringify(src) : src,\n    isModule,\n    toBuffer(options)\n  );\n}\n\nfunction toBuffer(raw) {\n  return Buffer.from(JSON.stringify(raw));\n}\n"]}